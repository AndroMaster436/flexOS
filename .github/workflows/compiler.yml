name: OSCompiler

on:
  push:
      branches: main

jobs:
  deploy:
      runs-on: ubuntu-latest
      steps:
      - uses: actions/checkout@v3
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '6.0.x'
      - name: Build Cosmos
        run: |
          sudo apt-get install yasm mkisofs make binutils git && \
            cd ~ && \
            mkdir cosmos && \
            cd cosmos && \
            git clone https://github.com/CosmosOS/Cosmos --depth 1 && \
            git clone https://github.com/CosmosOS/IL2CPU --depth 1 && \
            git clone https://github.com/CosmosOS/XSharp --depth 1 && \
            git clone https://github.com/CosmosOS/Common --depth 1 && \
            cd Cosmos && \
            sudo make
      - name: Build
        run: cd flexOS && dotnet build